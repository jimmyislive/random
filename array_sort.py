'''
Given an array with integers, with each integer being at most n positions away 
from its final position, what would be the best sorting algorithm?

so theoretically, if k is much smaller than log(n) this will give better performance that nlogn - ? (maybe...)
'''


def main(arr, k):

    max_len = len(arr)
    for i in range(max_len):
        #first look left
        current = i
        for j in range(1,k + 1):
            if current - j >= 0 and arr[current] < arr[current - j]:
                #swap them
                arr[current], arr[current - j] = arr[current - j], arr[current]

        #now look right
        for j in range(1,k + 1):
            if current + j <= (len(arr) - 1) and arr[current] > arr[current + j]:
                #swap them
                arr[current], arr[current + j] = arr[current + j], arr[current]

    return arr

if __name__ == '__main__':
    assert main([1,8,6,9,3,5,7], 4) == [1, 3, 5, 6, 7, 8, 9]
    assert main([5,1,4,2,8], 3) == [1, 2, 4, 5, 8]
    #look, works with duplicates too !
    assert main([116, 14, 130, 67, 31, 22, 69, 22, 78, 19, 167, 57, 63, 2, 95, 16, 36, 23, 110, 183], 15) == [2, 14, 16, 19, 22, 22, 23, 31, 36, 57, 63, 67, 69, 78, 95, 110, 116, 130, 167, 183]
    assert main([9, 10, 11, 16, 18, 21, 30, 34, 43, 47, 50, 57, 57, 58, 64, 64, 69, 71, 76, 83, 84, 92, 92, 93, 113, 120, 123, 158, 172, 173, 186, 187, 194, 197, 200, 201, 202, 206, 216, 219, 219, 223, 229, 230, 233, 236, 238, 247, 256, 258, 263, 267, 275, 275, 282, 285, 287, 289, 298, 316, 344, 367, 378, 379, 385, 394, 406, 417, 435, 447, 450, 456, 460, 467, 511, 511, 519, 521, 529, 538, 538, 542, 547, 548, 549, 578, 579, 580, 583, 591, 592, 601, 602, 623, 628, 638, 644, 646, 658, 666, 667, 672, 685, 688, 690, 690, 691, 694, 695, 714, 714, 719, 748, 765, 768, 772, 794, 797, 798, 809, 820, 820, 827, 834, 834, 840, 859, 868, 881, 889, 897, 900, 901, 901, 909, 919, 930, 931, 933, 943, 951, 967, 968, 976, 977, 982, 993, 998, 1006, 1010, 1014, 1023, 1024, 1030, 1049, 1064, 1069, 1084, 1091, 1094, 1098, 1102, 1103, 1119, 1132, 1142, 1160, 1163, 1166, 1171, 1192, 1203, 1206, 1209, 1217, 1218, 1224, 1244, 1245, 1247, 1250, 1255, 1258, 1259, 1261, 1264, 1273, 1273, 1274, 1280, 1304, 1306, 1309, 1313, 1314, 1327, 1332, 1332, 1334, 1337, 1360, 1372, 1373, 1385, 1386, 1388, 1390, 1395, 1412, 1419, 1432, 1435, 1447, 1459, 1466, 1477, 1485, 1496, 1505, 1508, 1518, 1524, 1527, 1535, 1536, 1546, 1548, 1556, 1561, 1563, 1573, 1578, 1593, 1595, 1600, 1610, 1610, 1614, 1621, 1639, 1645, 1654, 1656, 1661, 1662, 1665, 1685, 1693, 1700, 1701, 1713, 1731, 1741, 1743, 1756, 1756, 1757, 1763, 1765, 1768, 1779, 1780, 1786, 1792, 1795, 1801, 1803, 1807, 1809, 1815, 1818, 1822, 1834, 1860, 1866, 1867, 1877, 1880, 1881, 1889, 1900, 1905, 1915, 1934, 1940, 1941, 1941, 1945, 1955, 1959, 1959, 1960, 1972, 1976, 1976, 1978, 1981, 1987, 1995, 1988], 2) == \
           [9, 10, 11, 16, 18, 21, 30, 34, 43, 47, 50, 57, 57, 58, 64, 64, 69, 71, 76, 83, 84, 92, 92, 93, 113, 120, 123, 158, 172, 173, 186, 187, 194, 197, 200, 201, 202, 206, 216, 219, 219, 223, 229, 230, 233, 236, 238, 247, 256, 258, 263, 267, 275, 275, 282, 285, 287, 289, 298, 316, 344, 367, 378, 379, 385, 394, 406, 417, 435, 447, 450, 456, 460, 467, 511, 511, 519, 521, 529, 538, 538, 542, 547, 548, 549, 578, 579, 580, 583, 591, 592, 601, 602, 623, 628, 638, 644, 646, 658, 666, 667, 672, 685, 688, 690, 690, 691, 694, 695, 714, 714, 719, 748, 765, 768, 772, 794, 797, 798, 809, 820, 820, 827, 834, 834, 840, 859, 868, 881, 889, 897, 900, 901, 901, 909, 919, 930, 931, 933, 943, 951, 967, 968, 976, 977, 982, 993, 998, 1006, 1010, 1014, 1023, 1024, 1030, 1049, 1064, 1069, 1084, 1091, 1094, 1098, 1102, 1103, 1119, 1132, 1142, 1160, 1163, 1166, 1171, 1192, 1203, 1206, 1209, 1217, 1218, 1224, 1244, 1245, 1247, 1250, 1255, 1258, 1259, 1261, 1264, 1273, 1273, 1274, 1280, 1304, 1306, 1309, 1313, 1314, 1327, 1332, 1332, 1334, 1337, 1360, 1372, 1373, 1385, 1386, 1388, 1390, 1395, 1412, 1419, 1432, 1435, 1447, 1459, 1466, 1477, 1485, 1496, 1505, 1508, 1518, 1524, 1527, 1535, 1536, 1546, 1548, 1556, 1561, 1563, 1573, 1578, 1593, 1595, 1600, 1610, 1610, 1614, 1621, 1639, 1645, 1654, 1656, 1661, 1662, 1665, 1685, 1693, 1700, 1701, 1713, 1731, 1741, 1743, 1756, 1756, 1757, 1763, 1765, 1768, 1779, 1780, 1786, 1792, 1795, 1801, 1803, 1807, 1809, 1815, 1818, 1822, 1834, 1860, 1866, 1867, 1877, 1880, 1881, 1889, 1900, 1905, 1915, 1934, 1940, 1941, 1941, 1945, 1955, 1959, 1959, 1960, 1972, 1976, 1976, 1978, 1981, 1987, 1988, 1995]
